<button
  type="button"
  class="btn"
  style="background-color: #000f55; color: #f6f3f9; border-radius: 10px"
  data-bs-toggle="modal"
  data-bs-target="#exampleModal"
  (click)="newTree()"
>
  Crear nodo
</button>

<app-shape-modal></app-shape-modal>
<div
  style="
    width: calc(100% - 330px);
    height: 600px;
    left: 330px;
    top: 144px;
    position: absolute;
    border-color: black;
    align-items: center;
    border-radius: 30px;
    border: 1px solid;
    display: flex;
    overflow: hidden;
  "
>
  <div
    data-bs-toggle="modal"
    data-bs-target="#hide-show"
    class="custom-container"
  >
    <div class="icon-container">
      <img
        class="icon-img"
        src="../../../assets/icons/u_eye-slash.svg"
        alt=""
      />
    </div>
    <div class="text-container">{{ countHidden }} Hidden branches</div>
  </div>

  <div id="chart_container">
    <div id="chart_div"></div>
  </div>
</div>

<!-- Modal -->
<div
  class="modal custom-modal fade modal-sm position-relative"
  id="hide-show"
  tabindex="-1"
  aria-labelledby="hide-showLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog2">
    <div class="modal-content">
      <div class="modal-header">
        <p class="modal-title" id="hide-showLabel">Branches</p>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body modal-body2">
        <div class="view-all">
          <div
            style="
              flex: 1 1 0;
              color: #111827;
              font-size: 14px;

              font-weight: 400;
              word-wrap: break-word;
            "
          >
            View all
          </div>
          <div style="width: 20px; height: 20px; position: relative">
            <img
              style="position: absolute"
              src="../../../assets/icons/Chevron down.svg"
              alt=""
            />
          </div>
        </div>
        <hr />

        <div class="branch" *ngFor="let tier of aux; index as i">
          <div (click)="modalHideAndShowBranch(tier, i)" class="branch-content">
            <div style="width: 24px; height: 24px; position: relative">
              <img
                style="position: absolute"
                src="../../../assets/icons/u_eye-slash2.svg"
                alt=""
                [src]="
                  tier.hidden === 0
                    ? '../../../assets/icons/u_eye.svg'
                    : '../../../assets/icons/u_eye-slash2.svg'
                "
              />
            </div>
            <div
              [style]="tier.hidden === 0 ? 'color: #00061f' : 'color: #64748b'"
              class="branch-name"
            >
              {{ tier.name }}
            </div>
          </div>
          <div class="brach-level-container">
            <div class="brach-level">{{ "L" + tier.tier }}</div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div
          class="col-md-12 d-flex justify-content-between align-items-start w-100 mb-0"
        >
          <button
            data-bs-dismiss="modal"
            type="button"
            class="btn btn-sm delete-variable-button col-md-5 mb-0"
          >
            Cancel
          </button>

          <button
            data-bs-dismiss="modal"
            type="button"
            class="btn btn-sm save-variable-button col-md-5"
          >
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="contenidoContainer">
  <div
    style="
      top: 765px;
      width: calc(100% - 330px);
      left: 330px;
      position: absolute;
      flex-direction: column;
      justify-content: flex-start;
      align-items: flex-end;
      gap: 15px;
      display: inline-flex;
    "
  >
    <div
      style="
        width: 100%;
        justify-content: space-between;
        align-items: center;
        display: inline-flex;
      "
    >
      <div
        style="
          color: black;
          font-size: 12px;

          font-weight: 500;
          line-height: 16px;
          word-wrap: break-word;
        "
      >
        Variables summary
      </div>
      <div
        style="
          height: 38px;
          padding-left: 13px;
          padding-right: 13px;
          padding-top: 9px;
          padding-bottom: 9px;
          background: #f6f3f9;
          box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.05);

          overflow: hidden;

          justify-content: flex-start;
          align-items: center;
          gap: 4px;
          display: flex;
        "
      >
        <!--         <div
          style="
            flex: 1 1 0;
            color: #111827;
            font-size: 14px;

            font-weight: 400;
            word-wrap: break-word;
          "
        >
          Choose a scenario
        </div> -->
        <!--         <div style="width: 20px; height: 20px; position: relative">
          <div
            style="
              width: 10px;
              height: 6px;
              left: 5px;
              top: 7px;
              position: absolute;
              background: #6b7280;
            "
          ></div>
        </div> -->
        <select
          style="border-radius: 15px"
          class="form-select"
          aria-label="Default select example"
          [(ngModel)]="selectedScenery"
          (change)="onSceneryChange()"
        >
          <option
            *ngFor="let scenerie of sceneries; let i = index"
            [value]="i"
            (click)="getSceneries(i)"
          >
            {{ scenerie }}
          </option>
        </select>
      </div>
    </div>
    <div
      style="
        width: 100%;
        background: white;
        box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.06);
        border-radius: 15px;
        overflow: hidden;
        border: 1px #e5e7eb solid;
        justify-content: flex-start;
        align-items: flex-start;
        display: inline-flex;
      "
    >
      <div
        style="
          width: 100%;
          flex-direction: column;
          justify-content: flex-start;
          align-items: flex-start;
          display: inline-flex;
        "
      >
        <table style="width: 100%" class="table">
          <thead>
            <tr class="table-light">
              <th style="width: 10%" scope="col">LAVEL</th>
              <th style="width: 70%" scope="col">NAME</th>
              <th style="width: 200%" scope="col">
                <div class="carousel">
                  <button class="button-year" (click)="prevYear()">
                    &#9664;
                  </button>
                  <span>{{ years[currentYearIndex] }}</span>
                  <button class="button-year" (click)="nextYear()">
                    &#9654;
                  </button>
                </div>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let tier of aux; index as i">
              <td
                [ngClass]="
                  tier.hidden === 0 ? 'branch-active' : 'branch-noactive'
                "
              >
                {{ "L" + tier.tier }}
              </td>
              <td
                [ngClass]="
                  tier.hidden === 0
                    ? 'branch-active-name'
                    : 'branch-noactive-name'
                "
              >
                <img
                  style="margin-right: 15px"
                  [src]="
                    tier.hidden === 0
                      ? '../../../assets/icons/u_eye.svg'
                      : '../../../assets/icons/u_eye-slash2.svg'
                  "
                  alt=""
                />
                {{ tier.name }}
              </td>
              <td
                [ngClass]="
                  tier.hidden === 0
                    ? 'branch-active-name'
                    : 'branch-noactive-name'
                "
              >
                <div
                  class="d-flex"
                  *ngFor="let showScenerie of showSceneries[i] | keyvalue"
                >
                  {{ showScenerie.key }}: {{ showScenerie.value }}
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<app-edit-variable
  [variableId]="nodeName"
  [variableFather]="fatherNode"
  [editVariable]="editVariable"
  (sendDataEvent)="getDataFromModal($event)"
  (editDataEvent)="editDataFromModal($event)"
  (hiddenDataEvent)="findAndHideFatherNode()"
  (deleteNode)="deleteNode()"
  [isHidden]="hidden"
  [aux]="aux"
  [isNewTree]="isNewTree"
  [nodeId]="nodeName"
  [projectId]="id"
></app-edit-variable>
<app-unite-modal
  (sendEsceneriesEvent)="getSceneries2($event)"
  (printAllEvent)="printAll()"
  [nodeId]="nodeName"
  [edit]="editVariable"
  [cleanEsceneries]="cleanSceneries"
></app-unite-modal>
